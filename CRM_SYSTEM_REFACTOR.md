# CRMç³»ç»Ÿé‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ¯ é‡æ„ç›®æ ‡
å°†åŸæ¥çš„ç®€å•ç”¨æˆ·ç³»ç»Ÿé‡æ„ä¸ºå®Œæ•´çš„CRMï¼ˆå®¢æˆ·å…³ç³»ç®¡ç†ï¼‰ç³»ç»Ÿï¼Œæ”¯æŒHRâ†’ä¸»ç®¡â†’å¸¦æ•™è€å¸ˆçš„å®Œæ•´å·¥ä½œæµã€‚

## âœ… å·²å®Œæˆçš„é‡æ„å†…å®¹

### 1. åç«¯é‡æ„

#### User.js æ¨¡å‹é‡æ„
```javascript
// æ–°å¢è§’è‰²æšä¸¾
enum: ['part_time', 'mentor', 'boss', 'finance', 'manager', 'hr', 'lead']

// æ–°å¢å­—æ®µ
phone: String,           // ç”µè¯
wechat: String,          // å¾®ä¿¡
notes: String,           // å¤‡æ³¨
integral_w: String,      // ç§¯åˆ†å·W
integral_z: String,      // ç§¯åˆ†å·Z

// å±‚çº§ç®¡ç†å­—æ®µ
created_by: ObjectId,    // HRåˆ›å»ºè€…
managed_by: ObjectId     // å¸¦æ•™è€å¸ˆç®¡ç†è€…
```

#### æ–°å¢è·¯ç”±

**hr.js - HRè·¯ç”±**
- `POST /api/hr/create-lead` - åˆ›å»ºçº¿ç´¢
- `GET /api/hr/my-leads` - è·å–æˆ‘çš„çº¿ç´¢åˆ—è¡¨

**manager.js - ä¸»ç®¡è·¯ç”±**
- `GET /api/manager/leads` - è·å–å¾…åˆ†é…çº¿ç´¢
- `PUT /api/manager/assign-mentor/:leadId` - åˆ†é…çº¿ç´¢ç»™å¸¦æ•™è€å¸ˆ
- `GET /api/manager/mentor-list` - è·å–å¸¦æ•™è€å¸ˆåˆ—è¡¨
- `GET /api/manager/stats` - è·å–ä¸»ç®¡ç»Ÿè®¡

#### ä¿®æ”¹ç°æœ‰è·¯ç”±

**users.js - ç”¨æˆ·è·¯ç”±å¢å¼º**
- `PUT /api/users/:id` - å¢å¼ºæƒé™æ§åˆ¶
  - å¸¦æ•™è€å¸ˆåªèƒ½ä¿®æ”¹è‡ªå·±åä¸‹ç”¨æˆ·çš„ `integral_w` å’Œ `integral_z`
  - ä¸»ç®¡å’Œè€æ¿å¯ä»¥ä¿®æ”¹æ›´å¤šå­—æ®µ

### 2. å‰ç«¯é‡æ„

#### App.js - è·¯ç”±é‡æ„
```javascript
// æ ¹æ®è§’è‰²åŠ¨æ€æ¸²æŸ“ä¸»é¡µé¢
const RoleBasedDashboard = () => {
  switch (user.role) {
    case 'hr': return <HrDashboard />;
    case 'manager': return <ManagerDashboard />;
    case 'mentor': return <MentorDashboard />;
    default: return <Dashboard />;
  }
};
```

#### æ–°å¢é¡µé¢ç»„ä»¶

**HrDashboard.js - HRé¡µé¢**
- âœ… åˆ›å»ºçº¿ç´¢è¡¨å•ï¼ˆå§“åã€ç”µè¯ã€å¾®ä¿¡ã€å¤‡æ³¨ï¼‰
- âœ… çº¿ç´¢åˆ—è¡¨å±•ç¤ºï¼ˆçŠ¶æ€ã€åˆ†é…æƒ…å†µï¼‰
- âœ… è°ƒç”¨ `POST /api/hr/create-lead`

**ManagerDashboard.js - ä¸»ç®¡é¡µé¢**
- âœ… å¾…åˆ†é…çº¿ç´¢åˆ—è¡¨ï¼ˆæ”¯æŒæœç´¢ï¼‰
- âœ… åˆ†é…å¸¦æ•™è€å¸ˆåŠŸèƒ½ï¼ˆModal + Selectï¼‰
- âœ… è°ƒç”¨ `GET /api/manager/leads` å’Œ `PUT /api/manager/assign-mentor/:leadId`

**MentorDashboard.js - å¸¦æ•™è€å¸ˆé¡µé¢**
- âœ… æˆ‘çš„å®¢æˆ·åˆ—è¡¨
- âœ… ç¼–è¾‘ç§¯åˆ†ä¿¡æ¯ï¼ˆintegral_w, integral_zï¼‰
- âœ… è°ƒç”¨ `PUT /api/users/:id`

#### Layout.js - èœå•é‡æ„
```javascript
// æ ¹æ®è§’è‰²åŠ¨æ€ç”Ÿæˆèœå•
const getMenuItems = () => {
  // è€æ¿çœ‹åˆ°æ‰€æœ‰èœå•
  // å…¶ä»–è§’è‰²åªçœ‹åˆ°ç›¸å…³åŠŸèƒ½
};
```

## ğŸ”„ å®Œæ•´å·¥ä½œæµ

### HR â†’ ä¸»ç®¡ â†’ å¸¦æ•™è€å¸ˆ æµç¨‹

1. **HRåˆ›å»ºçº¿ç´¢**
   ```
   POST /api/hr/create-lead
   role: 'lead', created_by: HR ID
   ```

2. **ä¸»ç®¡åˆ†é…å¸¦æ•™è€å¸ˆ**
   ```
   PUT /api/manager/assign-mentor/:leadId
   role: 'lead' â†’ 'part_time', managed_by: å¸¦æ•™è€å¸ˆID
   ```

3. **å¸¦æ•™è€å¸ˆå®Œå–„èµ„æ–™**
   ```
   PUT /api/users/:userId
   æ›´æ–° integral_w, integral_z ç­‰ä¿¡æ¯
   ```

## ğŸ¨ å‰ç«¯ç•Œé¢ç‰¹æ€§

### HRé¡µé¢
- ğŸ“ å†…è”è¡¨å•åˆ›å»ºçº¿ç´¢
- ğŸ“‹ è¡¨æ ¼æ˜¾ç¤ºçº¿ç´¢çŠ¶æ€
- ğŸ” çŠ¶æ€æ ‡ç­¾ï¼ˆå¾…åˆ†é…/å·²åˆ†é…ç»™XXXï¼‰

### ä¸»ç®¡é¡µé¢
- ğŸ” æœç´¢åŠŸèƒ½ï¼ˆå§“åã€ç”µè¯ã€å¾®ä¿¡ï¼‰
- ğŸ‘¥ åˆ†é…å¸¦æ•™è€å¸ˆModal
- ğŸ“Š ç»Ÿè®¡ä¿¡æ¯å±•ç¤º

### å¸¦æ•™è€å¸ˆé¡µé¢
- ğŸ‘¥ å®¢æˆ·åˆ—è¡¨ç®¡ç†
- âœï¸ ç¼–è¾‘ç§¯åˆ†ä¿¡æ¯Modal
- âœ… è¡¨å•éªŒè¯

## ğŸ” æƒé™æ§åˆ¶

| è§’è‰² | æƒé™ | ä¸»é¡µé¢ |
|------|------|--------|
| hr | åˆ›å»ºçº¿ç´¢ã€æŸ¥çœ‹çº¿ç´¢ | HrDashboard |
| manager | åˆ†é…çº¿ç´¢ã€ç®¡ç†å¸¦æ•™è€å¸ˆ | ManagerDashboard |
| mentor | ç®¡ç†å®¢æˆ·ã€ç¼–è¾‘ç§¯åˆ† | MentorDashboard |
| boss | æ‰€æœ‰æƒé™ | Dashboard + æ‰€æœ‰å­é¡µé¢ |

## ğŸ§ª æµ‹è¯•éªŒè¯

### åç«¯æµ‹è¯•
```bash
node test-crm-system.js
```
âœ… é”€å”®åˆ›å»ºçº¿ç´¢
âœ… ä¸»ç®¡åˆ†é…å®¢æœ
âœ… å®¢æœå®Œå–„èµ„æ–™
âœ… å®Œæ•´å·¥ä½œæµéªŒè¯

### å‰ç«¯æµ‹è¯•
```bash
node test-crm-frontend.js
```
âœ… è§’è‰²-basedè·¯ç”±
âœ… é¡µé¢åŠŸèƒ½éªŒè¯
âœ… UIç»„ä»¶æ­£å¸¸

## ğŸš€ éƒ¨ç½²è¯´æ˜

### å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯
npm run server

# å¯åŠ¨å‰ç«¯
npm run admin

# æˆ–è€…åŒæ—¶å¯åŠ¨
npm run dev
```

### æµ‹è¯•è´¦å·
- HR: `hr` / `admin123`
- ä¸»ç®¡: `manager` / `admin123`
- å¸¦æ•™è€å¸ˆ: `mentor` / `admin123`
- è€æ¿: `boss` / `admin123`

## ğŸ‰ é‡æ„æˆæœ

1. **å®Œæ•´çš„CRMå·¥ä½œæµ** - ä»çº¿ç´¢åˆ›å»ºåˆ°å®¢æˆ·è½¬åŒ–çš„é—­ç¯
2. **è§’è‰²æƒé™ä½“ç³»** - ç²¾ç»†åŒ–çš„æƒé™æ§åˆ¶
3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–** - å„è§’è‰²ä¸“å±ç•Œé¢
4. **æ•°æ®å…³ç³»å®Œæ•´** - created_by å’Œ managed_by å»ºç«‹æ¸…æ™°å…³ç³»é“¾
5. **å¯æ‰©å±•æ¶æ„** - æ”¯æŒæœªæ¥æ·»åŠ æ›´å¤šè§’è‰²å’ŒåŠŸèƒ½

CRMç³»ç»Ÿé‡æ„åœ†æ»¡å®Œæˆï¼ç°åœ¨æ‚¨æ‹¥æœ‰äº†ä¸€ä¸ªä¼ä¸šçº§çš„ç´ äººåˆ†å‘å®¢æˆ·å…³ç³»ç®¡ç†ç³»ç»Ÿã€‚ğŸŠ